!function(t,s){s(document).ready(function(){t.init()});var o,e,i,n,r,l,u=!1;function a(){s("#gform-lock-request-status").html(gform.utils.escapeHtml(i.noResponse)),s("#gform-lock-request-button").attr("disabled",!1).text(i.requestAgain),l=!!(u=!1),wp.heartbeat.interval(30)}t.init=function(){n=gflockingVars.hasLock,o=gflockingVars.objectID,e=gflockingVars.objectType,r=gflockingVars.lockUI,i=gflockingVars.strings,function(){wp.heartbeat.interval(30),s("#wpwrap").append(r);var c="gform-refresh-lock-"+e,a="gform-request-lock-"+e;s(document).on("heartbeat-send."+c,function(t,e){var r={};o&&s("#gform-lock-dialog").length&&0!=n&&(r.objectID=o,e[c]=r)}),s(document).on("heartbeat-send."+a,function(t,e){var r={};if(!u)return e;r.objectID=o,e[a]=r}),s(document).on("heartbeat-tick."+c,function(t,e){var r,o,a;e[c]&&((r=e[c]).lock_error||r.lock_request)&&(a=r.lock_error||r.lock_request,(e=s("#gform-lock-dialog")).length&&(e.is(":visible")?r.lock_error?s("#gform-reject-lock-request-button").is(":visible")&&(r.lock_error.avatar_src&&(o=s('<img class="avatar avatar-64 photo" width="64" height="64" />').attr("src",r.lock_error.avatar_src.replace(/&amp;/g,"&")),e.find("div.gform-locked-avatar").empty().append(o)),s("#gform-reject-lock-request-button").hide(),e.show().find(".currently-editing").text(r.lock_error.text)):r.lock_request&&s("#gform-lock-request-status").html(gform.utils.escapeScripts(r.lock_request.text)):(a.avatar_src&&(o=s('<img class="avatar avatar-64 photo" width="64" height="64" />').attr("src",a.avatar_src.replace(/&amp;/g,"&")),e.find("div.gform-locked-avatar").empty().append(o)),e.show().find(".currently-editing").text(a.text),r.lock_request?s("#gform-reject-lock-request-button").show():s("#gform-reject-lock-request-button").hide(),e.find(".wp-tab-first").focus())))}),s(document).on("heartbeat-tick."+a,function(t,e){var r,o;if(e[a]&&(r=e[a]).status&&(o=r.status,s("#gform-lock-dialog").length))switch("pending"!=o&&(clearTimeout(l),u=l=!1),o){case"granted":s("#gform-lock-request-status").html(i.gainedControl),s("#gform-take-over-button").show(),s("#gform-lock-request-button").hide(),n=!0;break;case"deleted":s("#gform-lock-request-button").text(i.requestAgain).attr("disabled",!1),s("#gform-lock-request-status").html(i.rejected);break;case"pending":s("#gform-lock-request-status").html(i.pending)}})}(),s("#gform-lock-request-button").click(function(){var t=s(this);t.text("Request sent"),t.attr("disabled",!0),s("#gform-lock-request-status").html(""),u=!!1,wp.heartbeat.interval(5),l=setTimeout(a,12e4),s.getJSON(ajaxurl,{action:"gf_lock_request_"+e,object_id:o}).done(function(t){s("#gform-lock-request-status").html(gform.utils.escapeScripts(t.html))}).fail(function(t,e,r){r=e+", "+r;s("#gform-lock-request-status").html(gform.utils.escapeScripts(i.requestError+": "+r))})}),s("#gform-reject-lock-request-button").click(function(){s.getJSON(ajaxurl,{action:"gf_reject_lock_request_"+e,object_id:o,object_type:e}).done(function(t){s("#gform-lock-dialog").hide()}).fail(function(t,e,r){r=e+", "+r;s("#gform-lock-request-status").html(gform.utils.escapeScripts(i.requestError+": "+r)),s("#gform-lock-dialog").hide()})})}}(window.gflocking=window.gflocking||{},jQuery);